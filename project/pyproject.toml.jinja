[build-system]
requires = ["uv_build"]
build-backend = "uv_build"

[project]
name = "{{ python_package_distribution_name }}"
description = "{{ project_description }}"
authors = [{name = "{{ author_fullname }}", email = "{{ author_email }}"}]
license = "{{ copyright_license }}"
license-files = ["LICENSE"]
readme = "README.md"
requires-python = ">=3.13"
keywords = []
version = "0.0.0"
classifiers = [
    "Development Status :: 4 - Beta",
    "Intended Audience :: Developers",
    "Programming Language :: Python",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3 :: Only",
    "Programming Language :: Python :: 3.13",
    "Programming Language :: Python :: 3.14",
    "Programming Language :: Python :: 3.15",
    "Topic :: Documentation",
    "Topic :: Software Development",
    "Topic :: Utilities",
    "Typing :: Typed",
]
dependencies = [
    "prek",
]

[project.urls]
Homepage = "https://{{ repository_namespace }}.{{ repository_provider.rsplit('.', 1)[0] }}.io/{{ repository_name }}"
Documentation = "https://{{ repository_namespace }}.{{ repository_provider.rsplit('.', 1)[0] }}.io/{{ repository_name }}"
Changelog = "https://{{ repository_namespace }}.{{ repository_provider.rsplit('.', 1)[0] }}.io/{{ repository_name }}/changelog"
Repository = "https://{{ repository_provider }}/{{ repository_namespace }}/{{ repository_name }}"
Issues = "https://{{ repository_provider }}/{{ repository_namespace }}/{{ repository_name }}/issues"
Discussions = "https://{{ repository_provider }}/{{ repository_namespace }}/{{ repository_name }}/discussions"
Gitter = "https://gitter.im/{% if repository_namespace != author_username %}{{ repository_namespace }}/{{ repository_name }}{% else %}{{ repository_name }}/community{% endif %}"
{%- if repository_provider == "github.com" %}
Funding = "https://{{ repository_provider }}/sponsors/{{ author_username }}"
{%- endif %}

{% if python_package_command_line_name -%}
[project.scripts]
{{ python_package_command_line_name }} = "{{ python_package_import_name }}.cli:main"

{% endif -%}

[dependency-groups]
maintain = [
    "build",
    "yore",
    "python-semantic-release",
]
ci = [
    "ruff",
    "pytest",
    "pytest-cov",
    "pytest-randomly",
    "pytest-xdist",
    "ty",
    "poethepoet",
    "bandit",
    "vulture",
    "pyupgrade",
]
local = [
    "prek",
]
docs = [
    "markdown-callouts",
    "markdown-exec",
    "mkdocs",
    "mkdocs-coverage",
    "mkdocs-git-revision-date-localized-plugin",
    "mkdocs-llmstxt",
    "mkdocs-material",
    "mkdocs-minify-plugin",
    "mkdocs-material-extensions",
    "mkdocs-section-index",
    "mkdocstrings[python]",
    # YORE: EOL 3.10: Remove line.
    "tomli; python_version < '3.11'",
]

[tool.uv]
default-groups = ["maintain", "ci", "docs", "local"]

[tool.poe.tasks]
# Quality checks
lint = "ruff check src tests --config config/ruff.toml"
format = "ruff format src tests --config config/ruff.toml"
typecheck = "ty check src tests"
security = "bandit -r src -c config/bandit.toml"
deadcode = "vulture src --min-confidence 80"
upgrade = "pyupgrade --py313-plus src/**/*.py tests/**/*.py"

# Testing
test = "pytest tests -c config/pytest.ini"
test-cov = "pytest tests -c config/pytest.ini --cov=src --cov-report=html"

# Combined tasks
check = ["lint", "typecheck", "security", "deadcode"]
fix = ["format", "upgrade"]

# Pre-commit
pre-commit = "prek run --all-files"

# Documentation
docs = "mkdocs serve"
docs-build = "mkdocs build -s"
docs-deploy = "mkdocs gh-deploy"

# Setup
setup = "uv sync --all-extras --dev"

# VSCode configuration
vscode = "cp -r config/vscode/.vscode ."

# GitHub utilities
releases = "gh release list --limit 10"
tags = "sh -c 'git fetch --tags && git tag --sort=-version:refname'"
runs = "gh run list --limit 10"
watch = "gh run watch"

[tool.semantic_release]
version_toml = ["pyproject.toml:project.version"]
branch = "main"
build_command = "uv build"
commit_message = "chore(release): {version}"
tag_format = "{version}"

[tool.semantic_release.changelog]
template_dir = "templates"
changelog_file = "CHANGELOG.md"

[tool.semantic_release.commit_parser_options]
allowed_tags = ["build", "chore", "ci", "deps", "docs", "feat", "fix", "perf", "refactor", "style", "test"]
minor_tags = ["feat"]
patch_tags = ["fix", "perf"]
